<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>reveal-md</title>
        <link rel="stylesheet" href="./css/reveal.css">
        <link rel="stylesheet" href="./theme/puzzle.css" id="theme">
        <link rel="stylesheet" href="./css/highlight/zenburn.css">
        <link rel="stylesheet" href="./css/print/paper.css" type="text/css" media="print">

    </head>
    <body>

        <div class="reveal">
            <div class="slides"><section  data-markdown><script type="text/template"><!--section -->
# Jenkins Pipeline - Pipeline as Code

<!-- .slide: class="master02" -->
</script></section><section  data-markdown><script type="text/template">
## Agenda

* Jenkinsfile Intro
  * General Intro and purpose
     * Why should we use pipelines (see book) https://jenkins.io/doc/book/blueocean/#why-does-blue-ocean-exist
  * Glossar https://jenkins.io/doc/book/glossary/
  * Advantages
  * Imperative
  * Declarative <https://jenkins.io/doc/book/pipeline/syntax/>
  * Tooling Custom Tools
  * Best Practices
    * Folders
    * Slaves stateless
    * Shared Libraries --> Lab
  * Techlab
  * Setup (Lab and our own Jenkins)
  * OpenShift Integration
  * Jenkins Book
  * Examples
    * <https://jenkins.io/doc/pipeline/examples/>
    * <https://github.com/openshift/origin/tree/master/examples/jenkins/pipeline>

* global defaults, e.g. logrotate
https://jenkins.io/blog/2017/02/15/declarative-notifications/

https://www.cloudbees.com/sites/default/files/2016-jenkins-world-introducing_a_new_way_to_define_jenkins_pipelines_1.pdf

* Setup
* Hello Pipeline
* Stages, Locks, Milestones
* Build properties
   * log rotate
   * scm trigger
   * cron trigger
* Artefact archiving/stashing
* Credentials
  * ssh-agent
  * with_credentials
* Umgebungsvariabeln
* Build Tools
  * tools()
  * Automatisierung Puzzle
* Snippet Generator
* Error handling
* Quoting/Escaping
* Notification
  * mail
  * rocketchat
  * swoa committer only
* Debugging
   * replay
   * https://jenkins.io/doc/book/pipeline/development/
   * ...?
* Shared Libraries
* Multibranch
* OpenShift 3 Integration
  * Both plugins
* OpenShift Image Triggers
* OpenShift Slaves
* Image Promotion
* Blue Ocean
</script></section><section  data-markdown><script type="text/template">
## Agenda

* Introduction into Jenkins Pipeline and CI/CD, 60'
* Setup Lab Environment, 30'
* Hands-on Techlab, Rest of the Day
* Recap and Feedback, 15'
</script></section><section  data-markdown><script type="text/template">
## Objectives

* Learn about jenkins bestpractices
* Learn how to write Pipelines
* Learn about the different kinds of implementations
* Get a basic toolset on how to implement the basic use cases
</script></section><section  data-markdown><script type="text/template">
## Jenkins Basic Info

TODO image (master and slaves)

* Consists of Masters
  * Statefull
  * Management of Jobs, Users, Credentials, ...
  * Plugins (always run on master)
* and Slaves
  * Actually run the Jobs
  * Stateless
</script></section><section  data-markdown><script type="text/template">
## Scaling a Build Infrastructure

* jobs = number of developers * 3.333
* masters = number of jobs/500
* executors = number of jobs * 0.03

Source: https://jenkins.io/doc/book/architecting-for-scale/
</script></section><section  data-markdown><script type="text/template">
## Why a CI Server?

</script></section><section  data-markdown><script type="text/template">
![Fist](images/fist_by_jnatoli.jpg)

Source: http://jnatoli.deviantart.com/
</script></section><section  data-markdown><script type="text/template">
## Continuous Integration

* code in scm
* check-in and push at least daily
* automated compiling, testing, integrating and building
* reporting and code analysis
* deploy to integration environment
</script></section><section  data-markdown><script type="text/template">
## Continuous Delivery

“CONTINUOUS DELIVERY IS THE ABILITY TO GET CHANGES OF ALL TYPES—INCLUDING NEW FEATURES, CONFIGURATION CHANGES, BUG FIXES AND EXPERIMENTS—INTO PRODUCTION,OR INTO THE HANDS OF USERS, SAFELY AND QUICKLY IN A SUSTAINABLE WAY.”

-Jez Humble, continuousdelivery.com
</script></section><section  data-markdown><script type="text/template">
## Continuous Delivery

“CONTINUOUS DELIVERY IS THE ABILITY TO GET CHANGES OF **ALL TYPES**—INCLUDING NEW FEATURES, CONFIGURATION CHANGES, BUG FIXES AND EXPERIMENTS—INTO PRODUCTION,OR **INTO THE HANDS OF USERS, SAFELY AND QUICKLY IN A SUSTAINABLE WAY.**”

-Jez Humble, continuousdelivery.com
</script></section><section  data-markdown><script type="text/template">
## Continuous Delivery Pipeline

![Continuous Delivery Pipeline](images/ContinuousDeliveryPipeline.png)
</script></section><section  data-markdown><script type="text/template">
## Continuous Delivery != Continuous Deployment

![Continuous Delivery Not Continuous Deployment](images/ContinuousDeliveryNotDeployment.png)
</script></section><section  data-markdown><script type="text/template">
## Why should we use Pipelines

* Developer Experience
* Selfcontained
* Fully automated and documented
* Reusable
</script></section><section  data-markdown><script type="text/template">
## Pipeline Advantages

* Can be reviewed, forked, iterated upon and audited
* Running pipelines survive master restart
* Can stop and wait for human input
* Support complex CI/CD requirements
* DSL can be extended through shared libraries
</script></section><section  data-markdown><script type="text/template">
## Declarative vs Scripted

* Declarative: Validation => better error reporting
* Declarative: Better GUI support (Blue Ocean)
</script></section><section  data-markdown><script type="text/template">
## Custom Tools

TODO: how to use, what's the idea behind it, how to update, install other tools
</script></section><section  data-markdown><script type="text/template">
## Best Practices

* use folders
* keep the slave stateless
* archive artifacts
* reuse functionalities in shared libraries

</script></section><section  data-markdown><script type="text/template">
## Puzzle Jenkins Environment

* 1 master
* 1 main slave
* OpenShift docker slaves on demand
</script></section><section  data-markdown><script type="text/template">
## OpenShift Integration (1/2)

* currently Kuberentes plugin
* custom slaves build with its own pipeline
* project specific Slaves
</script></section><section  data-markdown><script type="text/template">
## OpenShift Integration (2/2)

prior to 1.0.14 (impl. of SimpleBuildStep)
```
step([$class: 'OpenShiftBuilder', apiURL: .....

```

after 1.0.14

```
def builder = openshiftBuild buildConfig: 'frontend'
```
</script></section><section  data-markdown><script type="text/template">
## Techlab Environment

* 1 master deployed on OpenShift techlab env
* every participant its own slave localy

</script></section><section ><section data-markdown><script type="text/template">
## Resources

* Jekins Book: <https://jenkins.io/doc/book/>
</script></section><section data-markdown><script type="text/template"></script></section></section></div>
        </div>

        <script src="./lib/js/head.min.js"></script>
        <script src="./js/reveal.js"></script>

        <script>
            function extend() {
              var target = {};
              for (var i = 0; i < arguments.length; i++) {
                var source = arguments[i];
                for (var key in source) {
                  if (source.hasOwnProperty(key)) {
                    target[key] = source[key];
                  }
                }
              }
              return target;
            }

            // Optional libraries used to extend on reveal.js
            var deps = [
              { src: './lib/js/classList.js', condition: function() { return !document.body.classList; } },
              { src: './plugin/markdown/marked.js', condition: function() { return !!document.querySelector('[data-markdown]'); } },
              { src: './plugin/markdown/markdown.js', condition: function() { return !!document.querySelector('[data-markdown]'); } },
              { src: './plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
              { src: './plugin/zoom-js/zoom.js', async: true },
              { src: './plugin/notes/notes.js', async: true },
              { src: './plugin/math/math.js', async: true }
            ];

            // default options to init reveal.js
            var defaultOptions = {
              controls: true,
              progress: true,
              history: true,
              center: true,
              transition: 'default', // none/fade/slide/convex/concave/zoom
              dependencies: deps
            };

            // options from URL query string
            var queryOptions = Reveal.getQueryHash() || {};

            var options = {};
            options = extend(defaultOptions, options, queryOptions);
            Reveal.initialize(options);
        </script>
        
    </body>
</html>
